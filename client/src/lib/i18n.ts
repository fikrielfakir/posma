export type Language = "fr" | "ar" | "darija";

export const languages: Record<Language, { name: string; dir: "ltr" | "rtl"; flag: string }> = {
  fr: { name: "Français", dir: "ltr", flag: "FR" },
  ar: { name: "العربية", dir: "rtl", flag: "MA" },
  darija: { name: "الدارجة", dir: "rtl", flag: "MA" },
};

export type Currency = "MAD" | "EUR" | "USD";

export const currencies: Record<Currency, { symbol: string; name: string; position: "before" | "after" }> = {
  MAD: { symbol: "DH", name: "Dirham Marocain", position: "after" },
  EUR: { symbol: "€", name: "Euro", position: "before" },
  USD: { symbol: "$", name: "US Dollar", position: "before" },
};

export const translations: Record<Language, Record<string, string>> = {
  fr: {
    dashboard: "Tableau de bord",
    products: "Produits",
    stock: "Stock",
    suppliers: "Fournisseurs",
    purchases: "Achats",
    sales: "Ventes",
    customers: "Clients",
    pos: "Point de Vente",
    cashSessions: "Caisse",
    inventory: "Inventaire",
    users: "Utilisateurs",
    settings: "Paramètres",
    logout: "Déconnexion",
    search: "Rechercher...",
    add: "Ajouter",
    edit: "Modifier",
    delete: "Supprimer",
    save: "Enregistrer",
    cancel: "Annuler",
    confirm: "Confirmer",
    actions: "Actions",
    status: "Statut",
    date: "Date",
    total: "Total",
    quantity: "Quantité",
    price: "Prix",
    name: "Nom",
    code: "Code",
    description: "Description",
    category: "Catégorie",
    family: "Famille",
    subcategory: "Sous-catégorie",
    warehouse: "Entrepôt",
    supplier: "Fournisseur",
    customer: "Client",
    invoice: "Facture",
    order: "Commande",
    payment: "Paiement",
    tva: "TVA",
    subtotal: "Sous-total",
    discount: "Remise",
    welcome: "Bienvenue",
    today: "Aujourd'hui",
    thisWeek: "Cette semaine",
    thisMonth: "Ce mois",
    totalSales: "Ventes totales",
    totalPurchases: "Achats totaux",
    lowStock: "Stock faible",
    pendingOrders: "Commandes en attente",
    activeProducts: "Produits actifs",
    alerts: "Alertes",
    recentTransactions: "Transactions récentes",
    topProducts: "Top produits",
    stockValue: "Valeur du stock",
    revenue: "Chiffre d'affaires",
    profit: "Bénéfice",
    expenses: "Dépenses",
    draft: "Brouillon",
    pending: "En attente",
    approved: "Approuvé",
    confirmed: "Confirmé",
    paid: "Payé",
    cancelled: "Annulé",
    received: "Reçu",
    partialReceived: "Partiellement reçu",
    ordered: "Commandé",
    inProgress: "En cours",
    completed: "Terminé",
    allWarehouses: "Tous les entrepôts",
    selectWarehouse: "Sélectionner un entrepôt",
    noData: "Aucune donnée",
    loading: "Chargement...",
    error: "Erreur",
    success: "Succès",
    warning: "Attention",
    info: "Information",
    critical: "Critique",
    outOfStock: "Rupture de stock",
    lowStockAlert: "Stock faible",
    overstock: "Surstock",
    slowMoving: "Rotation lente",
    expiring: "Expiration proche",
    viewAll: "Voir tout",
    quickActions: "Actions rapides",
    newSale: "Nouvelle vente",
    newPurchase: "Nouvel achat",
    newProduct: "Nouveau produit",
    stockEntry: "Entrée de stock",
    stockExit: "Sortie de stock",
    transfer: "Transfert",
    adjustment: "Ajustement",
    login: "Connexion",
    username: "Nom d'utilisateur",
    password: "Mot de passe",
    rememberMe: "Se souvenir de moi",
    forgotPassword: "Mot de passe oublié ?",
    invalidCredentials: "Identifiants invalides",
    phone: "Téléphone",
    email: "Email",
    address: "Adresse",
    city: "Ville",
    notes: "Notes",
    active: "Actif",
    inactive: "Inactif",
    role: "Rôle",
    permissions: "Permissions",
    fullName: "Nom complet",
    lastLogin: "Dernière connexion",
    purchasePrice: "Prix d'achat",
    sellingPrice: "Prix de vente",
    minStock: "Stock minimum",
    maxStock: "Stock maximum",
    currentStock: "Stock actuel",
    unit: "Unité",
    barcode: "Code-barres",
    sku: "SKU",
    pieces: "Pièces",
    kilograms: "Kilogrammes",
    grams: "Grammes",
    liters: "Litres",
    milliliters: "Millilitres",
    cartons: "Cartons",
    pallets: "Palettes",
    meters: "Mètres",
    squareMeters: "Mètres carrés",
    lots: "Lots",
    ice: "ICE",
    identifiantFiscal: "Identifiant Fiscal",
    taxeProfessionnelle: "Taxe Professionnelle",
    cnss: "CNSS",
    paymentTerms: "Délai de paiement",
    days: "jours",
    creditLimit: "Limite de crédit",
    currentBalance: "Solde actuel",
    orderNumber: "N° Commande",
    invoiceNumber: "N° Facture",
    orderDate: "Date de commande",
    expectedDate: "Date prévue",
    receivedDate: "Date de réception",
    dueDate: "Date d'échéance",
    saleDate: "Date de vente",
    paymentMethod: "Mode de paiement",
    cash: "Espèces",
    card: "Carte",
    check: "Chèque",
    bankTransfer: "Virement",
    mobilePayment: "Paiement mobile",
    inventorySession: "Session d'inventaire",
    expectedQuantity: "Quantité attendue",
    countedQuantity: "Quantité comptée",
    variance: "Écart",
    countedBy: "Compté par",
    startInventory: "Démarrer l'inventaire",
    finishInventory: "Terminer l'inventaire",
    movementType: "Type de mouvement",
    entry: "Entrée",
    exit: "Sortie",
    transferIn: "Transfert entrant",
    transferOut: "Transfert sortant",
    reason: "Motif",
    purchase: "Achat",
    sale: "Vente",
    returnClient: "Retour client",
    returnSupplier: "Retour fournisseur",
    loss: "Perte",
    damage: "Casse",
    sample: "Échantillon",
    gift: "Don",
    inventoryAdjustment: "Ajustement inventaire",
    darkMode: "Mode sombre",
    lightMode: "Mode clair",
    language: "Langue",
    currency: "Devise",
    timezone: "Fuseau horaire",
    companySettings: "Paramètres entreprise",
    profile: "Profil",
    notifications: "Notifications",
    security: "Sécurité",
    vendors: "Vendeurs",
  },
  ar: {
    dashboard: "لوحة القيادة",
    products: "المنتجات",
    stock: "المخزون",
    suppliers: "الموردون",
    purchases: "المشتريات",
    sales: "المبيعات",
    customers: "العملاء",
    pos: "نقطة البيع",
    cashSessions: "الصندوق",
    inventory: "الجرد",
    users: "المستخدمون",
    settings: "الإعدادات",
    logout: "تسجيل الخروج",
    search: "بحث...",
    add: "إضافة",
    edit: "تعديل",
    delete: "حذف",
    save: "حفظ",
    cancel: "إلغاء",
    confirm: "تأكيد",
    actions: "الإجراءات",
    status: "الحالة",
    date: "التاريخ",
    total: "المجموع",
    quantity: "الكمية",
    price: "السعر",
    name: "الاسم",
    code: "الرمز",
    description: "الوصف",
    category: "الفئة",
    family: "العائلة",
    subcategory: "الفئة الفرعية",
    warehouse: "المستودع",
    supplier: "المورد",
    customer: "العميل",
    invoice: "الفاتورة",
    order: "الطلب",
    payment: "الدفع",
    tva: "ضريبة القيمة المضافة",
    subtotal: "المجموع الفرعي",
    discount: "الخصم",
    welcome: "مرحبا",
    today: "اليوم",
    thisWeek: "هذا الأسبوع",
    thisMonth: "هذا الشهر",
    totalSales: "إجمالي المبيعات",
    totalPurchases: "إجمالي المشتريات",
    lowStock: "مخزون منخفض",
    pendingOrders: "الطلبات المعلقة",
    activeProducts: "المنتجات النشطة",
    alerts: "التنبيهات",
    recentTransactions: "المعاملات الأخيرة",
    topProducts: "أفضل المنتجات",
    stockValue: "قيمة المخزون",
    revenue: "الإيرادات",
    profit: "الربح",
    expenses: "النفقات",
    draft: "مسودة",
    pending: "قيد الانتظار",
    approved: "معتمد",
    confirmed: "مؤكد",
    paid: "مدفوع",
    cancelled: "ملغى",
    received: "مستلم",
    partialReceived: "مستلم جزئيا",
    ordered: "مطلوب",
    inProgress: "قيد التنفيذ",
    completed: "مكتمل",
    allWarehouses: "جميع المستودعات",
    selectWarehouse: "اختر المستودع",
    noData: "لا توجد بيانات",
    loading: "جاري التحميل...",
    error: "خطأ",
    success: "نجاح",
    warning: "تحذير",
    info: "معلومات",
    critical: "حرج",
    outOfStock: "نفاد المخزون",
    lowStockAlert: "تنبيه مخزون منخفض",
    overstock: "فائض المخزون",
    slowMoving: "بطيء الحركة",
    expiring: "قرب انتهاء الصلاحية",
    viewAll: "عرض الكل",
    quickActions: "إجراءات سريعة",
    newSale: "بيع جديد",
    newPurchase: "شراء جديد",
    newProduct: "منتج جديد",
    stockEntry: "إدخال مخزون",
    stockExit: "إخراج مخزون",
    transfer: "نقل",
    adjustment: "تعديل",
    login: "تسجيل الدخول",
    username: "اسم المستخدم",
    password: "كلمة المرور",
    rememberMe: "تذكرني",
    forgotPassword: "نسيت كلمة المرور؟",
    invalidCredentials: "بيانات الاعتماد غير صالحة",
    phone: "الهاتف",
    email: "البريد الإلكتروني",
    address: "العنوان",
    city: "المدينة",
    notes: "ملاحظات",
    active: "نشط",
    inactive: "غير نشط",
    role: "الدور",
    permissions: "الصلاحيات",
    fullName: "الاسم الكامل",
    lastLogin: "آخر تسجيل دخول",
    purchasePrice: "سعر الشراء",
    sellingPrice: "سعر البيع",
    minStock: "الحد الأدنى للمخزون",
    maxStock: "الحد الأقصى للمخزون",
    currentStock: "المخزون الحالي",
    unit: "الوحدة",
    barcode: "الباركود",
    sku: "رمز المنتج",
    pieces: "قطع",
    kilograms: "كيلوغرام",
    grams: "غرام",
    liters: "لتر",
    milliliters: "ميليلتر",
    cartons: "كراتين",
    pallets: "منصات",
    meters: "متر",
    squareMeters: "متر مربع",
    lots: "دفعات",
    ice: "الرقم الجبائي الموحد",
    identifiantFiscal: "المعرف الضريبي",
    taxeProfessionnelle: "الضريبة المهنية",
    cnss: "الصندوق الوطني للضمان الاجتماعي",
    paymentTerms: "شروط الدفع",
    days: "أيام",
    creditLimit: "حد الائتمان",
    currentBalance: "الرصيد الحالي",
    orderNumber: "رقم الطلب",
    invoiceNumber: "رقم الفاتورة",
    orderDate: "تاريخ الطلب",
    expectedDate: "التاريخ المتوقع",
    receivedDate: "تاريخ الاستلام",
    dueDate: "تاريخ الاستحقاق",
    saleDate: "تاريخ البيع",
    paymentMethod: "طريقة الدفع",
    cash: "نقدا",
    card: "بطاقة",
    check: "شيك",
    bankTransfer: "تحويل بنكي",
    mobilePayment: "دفع عبر الهاتف",
    inventorySession: "جلسة الجرد",
    expectedQuantity: "الكمية المتوقعة",
    countedQuantity: "الكمية المحسوبة",
    variance: "الفرق",
    countedBy: "أحصاها",
    startInventory: "بدء الجرد",
    finishInventory: "إنهاء الجرد",
    movementType: "نوع الحركة",
    entry: "دخول",
    exit: "خروج",
    transferIn: "نقل وارد",
    transferOut: "نقل صادر",
    reason: "السبب",
    purchase: "شراء",
    sale: "بيع",
    returnClient: "إرجاع عميل",
    returnSupplier: "إرجاع مورد",
    loss: "خسارة",
    damage: "تلف",
    sample: "عينة",
    gift: "هدية",
    inventoryAdjustment: "تعديل الجرد",
    darkMode: "الوضع الداكن",
    lightMode: "الوضع الفاتح",
    language: "اللغة",
    currency: "العملة",
    timezone: "المنطقة الزمنية",
    companySettings: "إعدادات الشركة",
    profile: "الملف الشخصي",
    notifications: "الإشعارات",
    security: "الأمان",
    vendors: "البائعين",
  },
  darija: {
    dashboard: "لوحة التحكم",
    products: "المنتجات",
    stock: "الستوك",
    suppliers: "الموردين",
    purchases: "الشراء",
    sales: "البيع",
    customers: "الكليان",
    pos: "الكاسة",
    cashSessions: "الصندوق",
    inventory: "الجرد",
    users: "المستخدمين",
    settings: "الإعدادات",
    logout: "خروج",
    search: "قلب...",
    add: "زيد",
    edit: "بدل",
    delete: "مسح",
    save: "سجل",
    cancel: "لغي",
    confirm: "أكد",
    actions: "الإجراءات",
    status: "الحالة",
    date: "التاريخ",
    total: "المجموع",
    quantity: "الكمية",
    price: "الثمن",
    name: "السمية",
    code: "الكود",
    description: "الوصف",
    category: "الفئة",
    family: "العائلة",
    subcategory: "الفئة الفرعية",
    warehouse: "المخزن",
    supplier: "المورد",
    customer: "الكليان",
    invoice: "الفاتورة",
    order: "الطلب",
    payment: "الخلاص",
    tva: "الضريبة",
    subtotal: "المجموع الفرعي",
    discount: "التخفيض",
    welcome: "مرحبا",
    today: "اليوم",
    thisWeek: "هاد السيمانة",
    thisMonth: "هاد الشهر",
    totalSales: "مجموع المبيعات",
    totalPurchases: "مجموع المشتريات",
    lowStock: "ستوك قليل",
    pendingOrders: "الطلبات المعلقة",
    activeProducts: "المنتجات النشطة",
    alerts: "التنبيهات",
    recentTransactions: "آخر المعاملات",
    topProducts: "أحسن المنتجات",
    stockValue: "قيمة الستوك",
    revenue: "رقم المعاملات",
    profit: "الربح",
    expenses: "المصاريف",
    draft: "مسودة",
    pending: "في الانتظار",
    approved: "مقبول",
    confirmed: "مؤكد",
    paid: "مخلص",
    cancelled: "ملغي",
    received: "وصل",
    partialReceived: "وصل شوية",
    ordered: "مطلوب",
    inProgress: "في الطريق",
    completed: "كمل",
    allWarehouses: "كل المخازن",
    selectWarehouse: "اختار المخزن",
    noData: "ما كاين والو",
    loading: "كيتحمل...",
    error: "مشكل",
    success: "تمام",
    warning: "انتباه",
    info: "معلومات",
    critical: "خطير",
    outOfStock: "سالي الستوك",
    lowStockAlert: "ستوك قليل",
    overstock: "بزاف ستوك",
    slowMoving: "ما كيتحركش",
    expiring: "غادي يسالي",
    viewAll: "شوف الكل",
    quickActions: "إجراءات سريعة",
    newSale: "بيع جديد",
    newPurchase: "شراء جديد",
    newProduct: "منتج جديد",
    stockEntry: "دخول ستوك",
    stockExit: "خروج ستوك",
    transfer: "نقل",
    adjustment: "تعديل",
    login: "دخول",
    username: "اسم المستخدم",
    password: "كلمة السر",
    rememberMe: "تفكرني",
    forgotPassword: "نسيتي كلمة السر؟",
    invalidCredentials: "المعلومات غالطة",
    phone: "التيليفون",
    email: "الإيمايل",
    address: "العنوان",
    city: "المدينة",
    notes: "ملاحظات",
    active: "نشط",
    inactive: "مسدود",
    role: "الدور",
    permissions: "الصلاحيات",
    fullName: "الاسم الكامل",
    lastLogin: "آخر دخول",
    purchasePrice: "ثمن الشراء",
    sellingPrice: "ثمن البيع",
    minStock: "أقل ستوك",
    maxStock: "أكثر ستوك",
    currentStock: "الستوك الحالي",
    unit: "الوحدة",
    barcode: "الباركود",
    sku: "رمز المنتج",
    pieces: "قطعة",
    kilograms: "كيلو",
    grams: "غرام",
    liters: "لتر",
    milliliters: "ميليلتر",
    cartons: "كراتين",
    pallets: "بالات",
    meters: "متر",
    squareMeters: "متر مربع",
    lots: "لوط",
    ice: "ICE",
    identifiantFiscal: "المعرف الضريبي",
    taxeProfessionnelle: "الضريبة المهنية",
    cnss: "CNSS",
    paymentTerms: "مدة الخلاص",
    days: "يوم",
    creditLimit: "حد الكريدي",
    currentBalance: "الرصيد الحالي",
    orderNumber: "رقم الطلب",
    invoiceNumber: "رقم الفاتورة",
    orderDate: "تاريخ الطلب",
    expectedDate: "التاريخ المتوقع",
    receivedDate: "تاريخ الوصول",
    dueDate: "تاريخ الاستحقاق",
    saleDate: "تاريخ البيع",
    paymentMethod: "طريقة الخلاص",
    cash: "كاش",
    card: "كارط",
    check: "شيك",
    bankTransfer: "تحويل بنكي",
    mobilePayment: "خلاص بالتيليفون",
    inventorySession: "حصة الجرد",
    expectedQuantity: "الكمية المتوقعة",
    countedQuantity: "الكمية المحسوبة",
    variance: "الفرق",
    countedBy: "حسبها",
    startInventory: "بدا الجرد",
    finishInventory: "كمل الجرد",
    movementType: "نوع الحركة",
    entry: "دخول",
    exit: "خروج",
    transferIn: "نقل داخل",
    transferOut: "نقل خارج",
    reason: "السبب",
    purchase: "شراء",
    sale: "بيع",
    returnClient: "رجاع كليان",
    returnSupplier: "رجاع مورد",
    loss: "خسارة",
    damage: "تكسير",
    sample: "عينة",
    gift: "هدية",
    inventoryAdjustment: "تعديل الجرد",
    darkMode: "الوضع المظلم",
    lightMode: "الوضع الفاتح",
    language: "اللغة",
    currency: "العملة",
    timezone: "التوقيت",
    companySettings: "إعدادات الشركة",
    profile: "البروفيل",
    notifications: "الإشعارات",
    security: "الأمان",
    vendors: "الباعة",
  },
};

export function formatCurrency(amount: number, currency: Currency = "MAD"): string {
  const curr = currencies[currency];
  const formatted = new Intl.NumberFormat("fr-MA", {
    minimumFractionDigits: 2,
    maximumFractionDigits: 2,
  }).format(amount);
  
  return curr.position === "before" 
    ? `${curr.symbol}${formatted}` 
    : `${formatted} ${curr.symbol}`;
}

export function formatNumber(num: number, decimals: number = 0): string {
  return new Intl.NumberFormat("fr-MA", {
    minimumFractionDigits: decimals,
    maximumFractionDigits: decimals,
  }).format(num);
}

export function formatDate(date: Date | string, lang: Language = "fr"): string {
  const d = typeof date === "string" ? new Date(date) : date;
  const locale = lang === "fr" ? "fr-MA" : "ar-MA";
  return new Intl.DateTimeFormat(locale, {
    year: "numeric",
    month: "short",
    day: "numeric",
  }).format(d);
}

export function formatDateTime(date: Date | string, lang: Language = "fr"): string {
  const d = typeof date === "string" ? new Date(date) : date;
  const locale = lang === "fr" ? "fr-MA" : "ar-MA";
  return new Intl.DateTimeFormat(locale, {
    year: "numeric",
    month: "short",
    day: "numeric",
    hour: "2-digit",
    minute: "2-digit",
  }).format(d);
}
